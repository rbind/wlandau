---
layout: post
title: "Showing hidden characters in text files"
comments: true
root: "../../../../"
--- 

<h2>Showing hidden characters in text files</h2>

<p>Recently, I tried to write a specialized csv file parser in C to 
read in data that I wanted to analyze. I had a tough time because,
contrary to my expectations, the lines in my csv file were delimited by 
the carriage return character, \r (hexidecimal index 0d), 
instead of the usual line feed character, \n (hexidecimal index 0a).</p>

<p>I saw my mistake when I opened the data file in
<a href = "http://ridiculousfish.com/hexfiend/">Hex Fiend</a> and
saw a 0d byte whenever I expected to see a 0a byte. Orignal problem diagnosed.</p>

<p>However, I was still unsatisfied. Hex editors are great, but I wanted a 
tool that combined the readability of human text with the honesty and full detail
of byte code. So I wrote SHASCII: Show Hidden ASCII, publicly available at
<a href="https://github.com/wlandau/shascii">https://github.com/wlandau/shascii</a>. 
It reads a text file and prints out the same text with
all the original ASCII control characters shown explicitly. The output
shows control characters in C language character escape code notation when possible:
for example, the line feed character is shown, literally, as \n. For control characters 
with no C language escape notation, caret notation is used.  If the -c flag is set,
caret notation is used for all ASCII control characters. All non-control characters are 
left alone.
<a href="http://en.wikipedia.org/wiki/Ascii">http://en.wikipedia.org/wiki/Ascii</a>
 has good expalnations of ASCII and these notations.</p> 

<p>As an example, take 
<a href="https://raw.github.com/wlandau/shascii/master/test.csv">
test.csv</a>. (Right-click the link and choose "Save Link As..." to save the 
document to your computer. If you copy and paste, then the \r 
characters will automatically become \n characters.)
If you open it an a simple text editor like 
<a href="http://support.apple.com/kb/ht2523">TextEdit</a>, you see:</p>

<pre><code>Geographic code,Person-years,No. of deaths
1003,323709,23
1015,215126,16
1043,189241,14
1055,210235,12
</code></pre>

To process this file, type <code>shascii -f test.csv</code> into the command line.
The output is:

<pre><code>Geographic code,Person-years,No. of deaths\r1003,323709,23\r1015,215126...
</code></pre>

<p>That's hard to read. So this time, let's break up the
output into separate lines using \r as the delimiter.
Enter <code>shascii -f test.csv -x d</code> into your
console. The output is:

<pre><code>Geographic code,Person-years,No. of deaths\r
1003,323709,23\r
1015,215126,16\r
1043,189241,14\r
1055,210235,12
</code></pre>

<p>Clearly, the \r character delimits lines in test.csv
instead of \n.</p>

<p>If I wanted to, I could have added the <code>-c</code>
flag:</p>

<pre><code>shascii -f test.csv -x d -c
</code></pre>

<p>which uses only caret notation for showing control characters
instead of a combination of caret notation and C escape notation:</p>

<pre><code>Geographic code,Person-years,No. of deaths^M
1003,323709,23^M
1015,215126,16^M
1043,189241,14^M
1055,210235,12
</code></pre>

<p>After some searching and experimentation, I realized that
<code>shascii -f test.csv -x a -c</code> does almost exactly  
the same thing as <code>cat -e test.csv</code>. The only difference
is that <code>cat -e</code> shows line feeds with <code>$</code>.
So, I guess I reinvented the wheel. Oops.</p>

<p>But here's a wheel that I don't think has been invented yet. There's
an opportunity to write a new kind of text editor. I'm imagining something like
<a href = "http://ridiculousfish.com/hexfiend/">Hex Fiend</a>,
but with output from <code>cat -e</code> or SHASCII instead of
byte code in one of the panels. Such an editor would combine the readability 
of human text with the honesty of byte code.</p>